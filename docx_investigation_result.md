# .docxファイル読み込み調査結果

## 調査結果サマリー
✅ **結論: .docxファイルは正常に読み込まれています**

### 読み込み確認内容
- 総ドキュメント数: 185
- .docxファイル: 17/17 ファイル読み込み成功
- 全てのフ��イルからコンテンツが正常に抽出されています

### 読み込まれている.docxファイル一覧
1. マーケティングミーティング議事録.docx
2. 全社ミーティング議事録.docx
3. 営業ミーティング議事録.docx
4. 採用ミーティング議事録.docx
5. 教育ミーティング議事録.docx
6. 開発ミーティング議事録.docx
7-11. 既存顧客の議事録 (5社)
12-14. 見込み顧客の議事録 (3社)
15. EcoTeeの代行出荷サービスについて.docx
16. Webサービス「EcoTee Creator」について.docx
17. Webサービス「EcoTee Creator」の利用ガイド.docx

## もし「読み込まれていない」と感じる場合の原因候補

### 1. チャンク分割の影響
- CHUNK_SIZE=500, CHUNK_OVERLAP=50 で分割されている
- 検索時に関連性が低いと判断されている可能性

### 2. 検索結果の順位
- MAX_RELATED_DOCUMENTS=5 で上位5件のみ取得
- .docxファイルより.pdfファイルのほうが関連性が高いと判断されている可能性

### 3. ベクトル検索の類似度
- 埋め込みモデル（OpenAIEmbeddings）による類似度計算で、
  .docxファイルの内容が検索クエリとマッチしていない可能性

### 4. ページ番号の問題
- .docxファイルにはページ番号メタデータが付与されない
  （metadataに'page'キーが存在しない）
- これは仕様であり、エラーではありません

## 推奨される確認方法

### 1. 特定のクエリで.docxファイルが返されるかテスト
例: "EcoTee Creatorについて教えて" → Webサービス関連の.docxが返されるはず

### 2. ログファイルの確認
`./logs/application.log` で実際にどのファイルが参照されているか確認

### 3. 検索結果数を増やす
constants.py の MAX_RELATED_DOCUMENTS を増やして、より多くの結果を表示
